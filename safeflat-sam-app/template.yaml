AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: >
  safeflat-sam-app

  Sample SAM Template for safeflat-sam-app

Globals:
  Function:
    Handler: main.handler
    Runtime: python3.11
    Architectures:
      - arm64
    Timeout: 900
    Layers:
      !Ref pythonDependenciesLayer

Resources:
  retrieveUrlsLambda:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: retrieveUrls
      CodeUri: retrieveUrls/
    Metadata:
      SamResourceId: retrieveUrls
  
  scrapeUrlsLambda:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: scrapeUrls
      CodeUri: scrapeUrls/
    Metadata:
      SamResourceId: scrapeUrls

  detectSubletsLambda:
    Type: AWS::Serverless::Function
    Properties:
      FunctionName: detectSublets
      CodeUri: detectSublets/
    Metadata:
      SamResourceId: detectSublets
  
  pythonDependenciesLayer:
    Type: AWS::Serverless::LayerVersion
    Properties:
      LayerName: pythonDependencies
      ContentUri: layer/
      CompatibleRuntimes:
        - python3.11
      CompatibleArchitectures:
        - arm64
      RetentionPolicy: Retain
